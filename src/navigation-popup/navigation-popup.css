/* SECTION: Left-side Navigation Popup */
.bullet-nav-launcher-left {
  /* Geometry config for the launcher tab */
  --nav-launcher-width: 32px;         /* full width of the paper tab */
  --nav-launcher-height: 64px;        /* full height of the tab */
  --nav-visible: 16px;                /* how much is visible when hidden */
  --nav-pull: calc(var(--nav-launcher-width) - var(--nav-visible));

  /* Visual tuning */
  --nav-tab-radius: 4px;              /* match sample; adjust if you tweak the curve */
  --nav-tab-border-w: 2px;            /* 1px is crisper than fractional widths */
  --nav-border-color: color-mix(in oklab, currentColor 22%, transparent);
  --nav-line-color: color-mix(in oklab, currentColor 40%, transparent);
  --nav-paper-fill: color-mix(in oklab, currentColor 6%, transparent);
  --nav-paper-fill-hover: color-mix(in oklab, currentColor 9%, transparent);
  --nav-border-color-hover: color-mix(in oklab, currentColor 28%, transparent);

  position: fixed;
  top: var(--outline-top, var(--outline-sticky-top));
  inset-inline-start: calc(-1 * var(--nav-pull)); /* sit flush to left edge with partial visibility */
  inline-size: var(--nav-launcher-width);
  block-size: var(--nav-launcher-height);

  display: inline-flex;
  color: var(--fg-color);

  /* Paper fill sits behind the bars; borders draw the open-tab outline (no left edge) */
  background-color: var(--nav-paper-fill);
  border-top: var(--nav-tab-border-w) solid var(--nav-border-color);
  border-right: var(--nav-tab-border-w) solid var(--nav-border-color);
  border-bottom: var(--nav-tab-border-w) solid var(--nav-border-color);
  border-left: 0;
  border-top-right-radius: var(--nav-tab-radius);
  border-bottom-right-radius: var(--nav-tab-radius);

  /* Draw the three horizontal “page lines” with layered gradients */
  background-image:
    linear-gradient(to right, var(--nav-line-color), var(--nav-line-color)),
    linear-gradient(to right, var(--nav-line-color), var(--nav-line-color)),
    linear-gradient(to right, var(--nav-line-color), var(--nav-line-color));
  background-repeat: no-repeat;
  background-size:
    16px 2px, /* top line */
    14px 2px, /* middle line */
    17px 2px; /* bottom line */
  background-position:
    6px 24px,
    6px 29px,
    6px 34px;

  cursor: pointer;
  z-index: var(--outline-z);
  padding: 0;
  transition:
    inset-inline-start 0.28s cubic-bezier(0.4, 0, 0.2, 1),
    opacity 0.12s ease,
    background-color 0.18s ease,
    border-color 0.18s ease;
  outline: none;
}

/* Reveal fully on hover or keyboard focus */
.bullet-nav-launcher-left:hover,
.bullet-nav-launcher-left:focus-visible {
  inset-inline-start: 0;
  background-color: var(--nav-paper-fill-hover);
  border-color: var(--nav-border-color-hover);
}

/* Hide the launcher when popup is open */
.bullet-nav-launcher-left:has(+ .bullet-nav-popup-left.open) {
  opacity: 0;
}

.bullet-nav-popup-left {
  position: fixed;
  z-index: calc(var(--outline-z) + 1);
  inset-inline-start: 8px;  /* small nudge so left border/shadow are visible */
  top: var(--outline-top, var(--outline-sticky-top));
  width: var(--outline-popup-width);
  /* Ensure popup never extends below viewport: cap by remaining space below dynamic top */
    max-height: min(var(--outline-popup-max-h),
        calc(100vh - var(--outline-top, var(--outline-sticky-top)) - 12px));
  background-color: var(--outline-bg);
  color: var(--outline-fg);
  border-radius: var(--outline-card-radius);
  box-shadow: var(--outline-shadow-1), var(--outline-shadow-2), var(--outline-border) 0 0 0 1px;
  overflow: auto;
  /* Prevent scroll chaining to page when reaching top/bottom */
    overscroll-behavior: contain;
  display: none;
  pointer-events: auto;

  /* Subtle, theme-aware scrollbar */
  scrollbar-width: thin;
  scrollbar-color: var(--outline-scrollbar-thumb) transparent;
}

.bullet-nav-popup-left.open {
  display: block;
}

/* Close button (hidden by default; shown in mobile fullscreen) */
.bullet-nav-close {
  display: none;
}
/* WebKit scrollbar styling (theme-aware via CSS variables) */
.bullet-nav-popup-left::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

.bullet-nav-popup-left::-webkit-scrollbar-track {
  background: transparent;
}

.bullet-nav-popup-left::-webkit-scrollbar-thumb {
  background-color: var(--outline-scrollbar-thumb);
  border-radius: 8px;
  border: 2px solid transparent; /* creates padding for the thumb */
  background-clip: padding-box;
}

.bullet-nav-popup-left::-webkit-scrollbar-thumb:hover {
  background-color: var(--outline-scrollbar-thumb-hover);
}

.bullet-nav-list {
  padding: var(--outline-popup-pad-top) var(--outline-popup-pad-x) 6px var(--outline-popup-pad-x);
  display: flex;
  flex-direction: column;
  gap: 1px;
}

.bullet-nav-item {
  display: flex;
  color: var(--outline-fg);
  text-decoration: none;
  user-select: none;
  cursor: pointer;
  padding: 4px;
  transition: color 0.15s ease, background-color 0.15s ease;
  border-radius: 8px;
}

.bullet-nav-item .title {
  display: -webkit-box;
  -webkit-box-orient: vertical;
  overflow: hidden;
  -webkit-line-clamp: 2;
  line-clamp: 2;
  line-height: 1.3;
  font-size: 13px;
}

.bullet-nav-item .icon {
  width: 1em;
    height: 1em;
  display: inline-flex;
  justify-content: center;
  margin-inline-end: 6px;
  flex: 0 0 auto;
}

/* Indentation by level (mirror outline spacing) */
.bullet-nav-item.level-1 {
  margin-inline-start: 0;
}
.bullet-nav-item.level-2 { margin-inline-start: 12px; }
.bullet-nav-item.level-3 { margin-inline-start: 24px; }

/* Active/current page in popup */
.bullet-nav-item.active {
  color: var(--outline-accent);
  background-color: transparent;
}
/* Hover/focus */
.bullet-nav-item:hover,
.bullet-nav-item:focus {
  background-color: var(--outline-hover-bg);
  outline: none;
}

.bullet-nav-item:focus-visible {
  outline: 2px solid var(--outline-accent);
  background: transparent;
}
/* Fullscreen presentation for touch/coarse devices, aligned with outline */
body.dsbullet-mobile-popup {
  .bullet-nav-popup-left.open {
    top: 0;
    inset-inline: 0;
    width: 100vw;
    height: 100vh;
    max-height: 100vh;
    display: flex;
    flex-direction: column;
  }

  .bullet-nav-close {
    display: inline-flex;
    flex: 0 0 auto;
    align-items: center;
    justify-content: center;
    align-self: flex-end;
    border: none;
    margin: 8px;
    font-size: 26px;
    width: 44px;
    height: 44px;
    border-radius: 8px;
    cursor: pointer;
  }

  .bullet-nav-close:focus-visible {
    outline: 2px solid var(--outline-accent);
  }

  .bullet-nav-list {
    padding: 8px var(--outline-popup-pad-x) 12px var(--outline-popup-pad-x);
    flex: 0 0 auto;
    overflow: auto;
    gap: 4px;
  }

  /* Hide the launcher while open on touch */
  .bullet-nav-launcher-left:has(+ .bullet-nav-popup-left.open) {
    opacity: 0;
    pointer-events: none;
  }

  .bullet-nav-item {
    padding: 10px 12px;
    min-height: 44px;
    align-items: baseline;
  }

  .bullet-nav-item .icon .notion-page-title-icon {
    font-size: 1em;
    height: 1em;
    width: 1em;
  }

  .bullet-nav-item .title {
    font-size: clamp(16px, 4.4vw, 18px);
    line-height: 1.4;
  }
}

@supports (height: 100dvh) {
  .bullet-nav-popup-left {
    max-height: min(var(--outline-popup-max-h),
        calc(100dvh - var(--outline-top, var(--outline-sticky-top)) - 12px));
  }

  body.dsbullet-mobile-popup .bullet-nav-popup-left.open {
    height: 100dvh;
    max-height: 100dvh;
  }
}

/* Prevent background scroll when popup is open in mobile */
html:has(body.dsbullet-mobile-popup .bullet-nav-popup-left.open),
body.dsbullet-mobile-popup:has(.bullet-nav-popup-left.open) {
  overflow: hidden;
  touch-action: pinch-zoom;
}